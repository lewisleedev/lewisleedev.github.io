---
layout: post
---

몇몇 특별한 보직이 아니라면 군대에서 일하면서 코딩과 가장 가까운 경험은 한셀의 매크로 스크립트일것이다. 엑셀 VBA에서 몇몇 기능이 빠진, 좀 더 불편한 물건인데, 기본적으로 가능성은 무궁무진하다보니 애용하게된다. 행정병으로 근 1년가까이 근무하면서 매크로덕을 많이 보았다. 아마 전공자든 나처럼 취미로하든, 엑셀 매크로를 공부해볼 일은 거의 없었을 것이라고 생각한다. 애초에 엑셀에서 VBA를 쓴다는 것 부터 처음 알게되었다. 전공자라면 VBA가 워낙 간단해서 굳이 이 시리즈가 아니더라도 이정도 사용법은 충분히 생각해낼 수 있을 것이라고 생각한다. **한셀 매크로로 일하기** 시리즈는 비전공자를 대상으로 군대에서 많이 쓰일법한 여러가지 프로그램(?)들을 만들어보면서 내가 스스로 배운 한셀과 한셀 매크로로 조금 더 편하게 일하는 방법을 소개해보려 한다.

VBA는 분명히 쉬운언어이고, 엑셀(한셀) 매크로는 그중에서도 언어 자체가 어려울 부분이 없다시피하기때문에 빠르게 배울 수 있었지만, 아주 기초적인 프로그래밍 언어에 대한 이해는 필요한 것 같다. 특히 객체지향형인만큼 Python을 조금이라도 배워둔 상태에서 배웠기때문에 빨리 배울 수 있었던 것 같다. 최대한 자세하게 설명해보겠지만, 이 시리즈는 프로그래밍 시리즈가 아니라 실전 한셀(엑셀이랑 다른점은 없지만)이기때문에 필요 이상의 설명은 하지 않을 것이다.

## 시작하기 전에

![한셀 스크립트 편집기](img/hancell_script_editor.PNG)

먼저 매크로는 *스크립트 편집기*라는 창에서 만들게되는데, SW자료실을 찾아보면 **Notepad++**가 있다. Atom, VSCode를 기대할 순 없다. (VBA자체가 워낙 단순해서 그닥 필요성을 못느끼게 되기도 한다.) Notepad++에서 만들고 붙여넣는 식이 훨씬 편하다. 한셀 매크로가 워낙 에러가 잦고 자주 팅기기도해서 한참 만들다가 전부 날려먹는 일이 많았다. 팅기는걸 보고 디버깅을 해야할때도 많다.

매크로는 일반적인 수식이랑 어떤점이 다를까? 데이터 색인, 조회등은 수식만으로도 충분하다. 하지만 1) 데이터 양이 엄청 많다면 2) 데이터의 입력, 수정을 해야할 경우엔 매크로가 필요하다. 조건을 만족하는 값을 찾아주는 것은 수식으로 충분하지만, 조건의 만족하는 값을 수정하는 것은 기본 기능으로는 불가능하다. 매크로 녹화기능도 단순작업은 반복할 수 있겠지만, 거의 모든 경우에는 의미가 없다.

매크로가 유용하게 쓰인 일례로 마일리지(또는 상벌점)이 있다. 우리 중대에서는 마일리지 제도가 있었는데, 마일리지 적립 내역을 기록하면서 사용할때마다 차감을 해야했다. 연속적인 기록을 하고 조회하는 것은 기본 엑셀의 기능으로도 충분하지만, 차감은 조금 까다롭다. 적립/사용하려는 사람이 몰려들면 직접 로그를 작성하는 것 마냥 기록하는 것은 훨씬 불편할 것이다. 마일리지 기록 관리를 맡게 된 후, 적잖은 개발기간 끝에(몇일은 걸린 듯 하다) 매크로를 사용해 한 시트에서 로그 확인/적립/사용을 모두 할 수 있었다.

정해진 형식의 문서에 각기 다른 값을 넣고 인쇄해야하는 작업이 있었는데, 데이터 값이 매우 많다면 매크로가 유용할 수 있다. 보통 표 형식의 인쇄물을 만들때면 아무리 다른 값이 많아도 한글로 만들곤 하는데, 한글은 단축키등에 익숙하다해도 사용자가 편집하는데에 스프레드시트 프로그램보다는 느릴 수 밖에 없다. 고정된 형식에 값만 바꿔넣어 인쇄하는 것이라면, 매크로를 만들어 인쇄하는 것이 시간을 정말 많이 줄여줄 수 있다.

매크로는 형식 수정에는 그닥 유용하지 않았다. 형식은 오류도 잦았고, 생각대로 되지 않는 경우가 많았다. 또한 한셀 자체가 안정성이 비교적 떨어지고, PC성능에도 한계가 있어 일정 크기 이상의 문서에서는 사용하기 힘들었다.

나는 전공자가 아니라, 이 시리즈에서 설명할 방법들은 알고리즘에대한 이해에서 도출된 방법보다는 실전에서 써먹기위해 생각해낸 방법들이 대부분이다. 그닥 쓸일은 없었지만 Quicksort정도는 도움이 됐던 것 같다. Naming Convention은 거의 지키지 않았고, 대부분의 경우에 camelCase를 사용했다. 추가로 책 [*엑셀 매크로 VBA 바이블*](http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&ejkGb=KOR&barcode=9788979149357)의 도움을 많이 받았다.

---

## 시리즈 보기

[1. 한셀 매크로로 일하기 (1)](https://dev.lewislee.net/%ED%95%9C%EC%85%80-%EB%A7%A4%ED%81%AC%EB%A1%9C%EB%A1%9C-%EC%9D%BC%ED%95%98%EA%B8%B0-1.html)